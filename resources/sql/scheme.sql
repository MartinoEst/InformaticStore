-- Creaci칩n de tablas
CREATE TABLE CLIENTES
(
	DNI			VARCHAR2(9),
	NOMBRE		VARCHAR2(25),
	APELLIDOS	VARCHAR2(50),
	DIRECCION	VARCHAR2(75),
	CONSTRAINT PK_CLI PRIMARY KEY(DNI),
	CONSTRAINT CK_NOMNONULL CHECK(NOMBRE IS NOT NULL)
);

CREATE TABLE PRODUCTOS
(
	ID_PROD			NUMBER(9),
	NOMBRE_PROD		VARCHAR2(50),
	PRECIO			NUMBER(7,2),
	UNIDADES		NUMBER(4),
	CONSTRAINT PK_PROD PRIMARY KEY(ID_PROD), 
	CONSTRAINT CK_NOM_PROD_NONULL CHECK(NOMBRE_PROD IS NOT NULL),
	CONSTRAINT CK_PREC_NONULL CHECK(PRECIO > 0)
);

CREATE TABLE CARRITO
(
	DNI				VARCHAR(9),
	ID_CARRO		NUMBER(9),
	NUM_ARTICULOS	NUMBER(4),
	IMPORTE_TOTAL	NUMBER(8,2),
	CONSTRAINT PK_CAR PRIMARY KEY(ID_CARRO), 
	CONSTRAINT CK_NUMARTNONULL CHECK(NUM_ARTICULOS > 0),
	CONSTRAINT CK_IMPORTENONULL CHECK(IMPORTE_TOTAL > 0)
);

CREATE TABLE CONTABILIDAD
(
	COMPRA 			NUMBER(8,2),
	VENTA			NUMBER(8,2),
	SALDO			NUMBER(8,2),
	ID_CONCEPTO		VARCHAR2(50),
	CONSTRAINT PK_PED PRIMARY KEY(ID_CONCEPTO), 
	CONSTRAINT CK_COMPRA_MAYORQUE0 CHECK(COMPRA > 0),
	CONSTRAINT CK_VENTA_MAYORQUE0 CHECK(VENTA > 0)
);

-- Creaci칩n de secuencias

CREATE SEQUENCE SEQ_PROD			
START WITH 1
INCREMENT BY 1
MINVALUE 1
MAXVALUE 999999999;

CREATE SEQUENCE SEQ_CARRITO			
START WITH 1
INCREMENT BY 1
MINVALUE 1
MAXVALUE 999999999;

-- Insercci칩n de datos de ejemplo

INSERT INTO CLIENTES VALUES('47546382F','David','Delgado Dominguez','Pimienta 25');
INSERT INTO CLIENTES VALUES('28882716D','Angustia','Perez Nieto','Real de Castilla 44');
INSERT INTO CLIENTES VALUES('96735614S','Paula','Garcia Cabrera','El Cortijo bonito 5');
INSERT INTO CLIENTES VALUES('11438876R','Francisco','Jimenez Arenas','Ilipa Magna 8');
INSERT INTO CLIENTES VALUES('96463992W','Alfonso','Gallardo Prieto','Villamar de la plata 73');
INSERT INTO CLIENTES VALUES('22459378L','Jose Antonio','Ruiz Calero','Conde de bustillo 81');
INSERT INTO CLIENTES VALUES('77619283A','Luis Mariano','Mesa Romero','La Cuesta 23');
INSERT INTO CLIENTES VALUES('34234719G','Jaime Antonio','Piquillo Montero','Buena Vista 13');
INSERT INTO CLIENTES VALUES('78883649M','Juan','Garrido Navarro','Trigo Verde 66');
INSERT INTO CLIENTES VALUES('33743259H','Gumersindo','Bravo  Guerra','Cadisua 51');

INSERT INTO PRODUCTOS VALUES(SEQ_PROD.NEXTVAL,'Raton Inalambrico',15.50,256);
INSERT INTO PRODUCTOS VALUES(SEQ_PROD.NEXTVAL,'Microprocesador AMD Athlon II X4 620',135.95,144);
INSERT INTO PRODUCTOS VALUES(SEQ_PROD.NEXTVAL,'Portatil Toshiba C850',486.47,22);
INSERT INTO PRODUCTOS VALUES(SEQ_PROD.NEXTVAL,'Pen Drive Transcend 4GB',44.25,67);
INSERT INTO PRODUCTOS VALUES(SEQ_PROD.NEXTVAL,'Cascos Natec Hummingbird',78.80,13);
INSERT INTO PRODUCTOS VALUES(SEQ_PROD.NEXTVAL,'Antivirus Nod 32',25.50,800);
INSERT INTO PRODUCTOS VALUES(SEQ_PROD.NEXTVAL,'Teclado Roccat',25.00,10);
INSERT INTO PRODUCTOS VALUES(SEQ_PROD.NEXTVAL,'Tablet Nexus',199.95,45);
INSERT INTO PRODUCTOS VALUES(SEQ_PROD.NEXTVAL,'HDD externo 320Gb',40.45,160);
INSERT INTO PRODUCTOS VALUES(SEQ_PROD.NEXTVAL,'Windows 7 Ultimate',126.50,420);


INSERT INTO CARRITO VALUES('96735614S',SEQ_CARRITO.NEXTVAL,12,3450.70);
INSERT INTO CARRITO VALUES('22459378L',SEQ_CARRITO.NEXTVAL,7,1450.46);
INSERT INTO CARRITO VALUES('96463992W',SEQ_CARRITO.NEXTVAL,54,911.75);
INSERT INTO CARRITO VALUES('11438876R',SEQ_CARRITO.NEXTVAL,4,2200.50);
INSERT INTO CARRITO VALUES('96463992W',SEQ_CARRITO.NEXTVAL,6,6100.07);
INSERT INTO CARRITO VALUES('22459378L',SEQ_CARRITO.NEXTVAL,11,2478.47);
INSERT INTO CARRITO VALUES('77619283A',SEQ_CARRITO.NEXTVAL,24,2500.50);
INSERT INTO CARRITO VALUES('34234719G',SEQ_CARRITO.NEXTVAL,68,57.70);
INSERT INTO CARRITO VALUES('78883649M',SEQ_CARRITO.NEXTVAL,350,170.15);
INSERT INTO CARRITO VALUES('33743259H',SEQ_CARRITO.NEXTVAL,289,570.41);

INSERT INTO CONTABILIDAD VALUES(2500.32,3450.70,950.38, 'Portatiles Toshiba');
INSERT INTO CONTABILIDAD VALUES(1032.40,1450.46,418.06, 'Ordenadores Mac');
INSERT INTO CONTABILIDAD VALUES(746.80,911.75,164.95, 'Monitores Samsungs Led');
INSERT INTO CONTABILIDAD VALUES(1255.25,2200.50,945.25, 'Softwares Antivirus');
INSERT INTO CONTABILIDAD VALUES(4032.22,6100.07,2067.85, 'Accesorios informaticos');
INSERT INTO CONTABILIDAD VALUES(2471.15,2478.47,7.32, 'Discos SSD');
INSERT INTO CONTABILIDAD VALUES(700.45,851.16,150.71, 'Unidades DVD');
INSERT INTO CONTABILIDAD VALUES(88.35,222.08,133.73, 'Tablets');
INSERT INTO CONTABILIDAD VALUES(991.38,992.01,0.63, 'Pendrives');
INSERT INTO CONTABILIDAD VALUES(348.52,619.90,271.38, 'Cascos');


-- A침ado las FK y su forma de borrados

ALTER TABLE CARRITO
ADD CONSTRAINT FK_CARRO_CLIE FOREIGN KEY(DNI) REFERENCES CLIENTES(DNI) ON DELETE SET NULL;

COMMIT;















